<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>volatile特性</title>
    <link rel="Stylesheet" type="text/css" href="./css/style.css" />
    <link rel="stylesheet" type="text/css" href="./google-code-prettify/prettify.css" >
    <!-- add more style sheets and javascripts -->
</head>
<body>
<!--<body onload="prettyPrint()">-->

<div class="content">

<div id="volatile特性"><h1 id="volatile特性" class="header"><a href="#volatile特性">volatile特性</a></h1></div>

<div id="volatile特性-Java内存模型"><h2 id="Java内存模型" class="header"><a href="#volatile特性-Java内存模型">Java内存模型</a></h2></div>
<p>
1.jvm虚拟机p364 8种操作
2.java内存模型规定执行上述8种操作的规则：8条，
  其中第二条：不允许一个线程丢弃它的最近的assign操作，即变量在工作内存中改变了之后必须把该变化同步到主内存。
</p>

<div id="volatile特性-volatile特性"><h2 id="volatile特性" class="header"><a href="#volatile特性-volatile特性">volatile特性</a></h2></div>
<div id="volatile特性-volatile特性-1.保证此变量对所有线程的可见性"><h3 id="1.保证此变量对所有线程的可见性" class="header"><a href="#volatile特性-volatile特性-1.保证此变量对所有线程的可见性">1.保证此变量对所有线程的可见性</a></h3></div>
<div id="volatile特性-volatile特性-2.禁止指令重排序优化"><h3 id="2.禁止指令重排序优化" class="header"><a href="#volatile特性-volatile特性-2.禁止指令重排序优化">2.禁止指令重排序优化</a></h3></div>

<p>
volatile指令把修改同步到内存时，意味着所有之前的操作都已经执行完成。
理解如下：
因为volatile指令执行之后，如果之前的操作未同步到内存，又因为assigin操作不可以被丢弃，所以它必定在之后某时刻执行。违背了volatile的”禁止指令重排序“的原则。
所以，volatile指令执行之后，之前的操作一定同步到了主内存。并且，在其他线程执行时，必定从主内存中同步到了工作内存。因为”执行“完成意味着其他线程cpu的实际执行，而实际执行是将共享变量从主内存中copy到工作内存中，再执行。
</p>

<div id="volatile特性-内存屏障是禁止指令重排序的实现方式"><h2 id="内存屏障是禁止指令重排序的实现方式" class="header"><a href="#volatile特性-内存屏障是禁止指令重排序的实现方式">内存屏障是禁止指令重排序的实现方式</a></h2></div>
<p>
对应汇编代码中的lock
</p>

</div>

<hr class="comment">
<section class="comment">
<div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'lotaboutvimwiki'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>
    <script src="./js/jquery-1.7.1.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
        $('pre').addClass('prettyprint linenums') 
        prettyPrint()})
    </script>
    <script src="./google-code-prettify/prettify.js"></script>

    <!--script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML-full"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML-full&latest"></script>
</body>
</html>
